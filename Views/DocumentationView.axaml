<UserControl xmlns="https://github.com/avaloniaui"
             x:Class="teams_phonemanager.Views.DocumentationView"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:fi="using:FluentIcons.Avalonia"
             xmlns:fic="using:FluentIcons.Common"
             xmlns:local="clr-namespace:teams_phonemanager.Views"
             xmlns:viewmodels="clr-namespace:teams_phonemanager.ViewModels"
             xmlns:converters="clr-namespace:teams_phonemanager.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="700" d:DesignWidth="900">

    <UserControl.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>

    <Grid>
        <Border Classes="card" Margin="0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Margin="24,24,24,16">
                    <TextBlock Text="Tenant Documentation" 
                             Classes="page-title"/>
                    <TextBlock Text="Export a complete overview of your Teams Phone System configuration â€” routing topology, phone numbers, users, schedules, and more."
                             TextWrapping="Wrap"
                             Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                             Margin="0,4,0,16"/>

                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <Button Command="{Binding ExportDocumentationCommand}"
                                Classes="IconText"
                                IsEnabled="{Binding !IsBusy}">
                            <StackPanel Orientation="Horizontal">
                                <fi:SymbolIcon Symbol="ArrowDownload" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                <TextBlock Text="Export Documentation" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>

                        <Button Command="{Binding CopyToClipboardCommand}"
                                Classes="IconText"
                                IsEnabled="{Binding !IsBusy}">
                            <StackPanel Orientation="Horizontal">
                                <fi:SymbolIcon Symbol="Copy" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                <TextBlock Text="Copy to Clipboard" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>

                    <!-- Status -->
                    <TextBlock Text="{Binding StatusMessage}"
                             Margin="0,12,0,0"
                             FontSize="13"
                             Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                             IsVisible="{Binding StatusMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                    
                    <!-- Progress indicator -->
                    <ProgressBar IsIndeterminate="True"
                                 IsVisible="{Binding IsExporting}"
                                 Margin="0,8,0,0"/>
                </StackPanel>

                <!-- Documentation Output -->
                <Border Grid.Row="1" 
                        Margin="24,0,24,24"
                        Background="{DynamicResource ControlFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="0">
                    <ScrollViewer HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Auto">
                        <TextBox Text="{Binding DocumentationOutput}"
                                 IsReadOnly="True"
                                 AcceptsReturn="True"
                                 TextWrapping="NoWrap"
                                 FontFamily="Cascadia Code, Consolas, Courier New, monospace"
                                 FontSize="12"
                                 BorderThickness="0"
                                 Padding="16"
                                 Watermark="Click 'Export Documentation' to generate a complete tenant overview with routing topology, phone numbers, users, schedules, and configuration details..."/>
                    </ScrollViewer>
                </Border>

                <!-- Info Footer -->
                <Border Grid.Row="2" 
                        Background="{DynamicResource ControlFillColorSecondaryBrush}"
                        Padding="24,12">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <fi:SymbolIcon Symbol="Info" FontSize="14"
                                     Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Text="The export queries your tenant live via PowerShell. Ensure you are connected before exporting."
                                 FontSize="12"
                                 Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                 VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>
