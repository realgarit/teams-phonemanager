<UserControl xmlns="https://github.com/avaloniaui"
             x:Class="teams_phonemanager.Views.VariablesView"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:fi="using:FluentIcons.Avalonia"
             xmlns:fic="using:FluentIcons.Common"
             xmlns:local="clr-namespace:teams_phonemanager.Views"
             xmlns:viewmodels="clr-namespace:teams_phonemanager.ViewModels"
             xmlns:converters="clr-namespace:teams_phonemanager.Converters"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    
    <UserControl.Resources>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
        <converters:TimeSpanConverter x:Key="TimeSpanConverter"/>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>

    <UserControl.Styles>
        <!-- Local styles removed, using App.axaml styles -->
        <Style Selector="fi|SymbolIcon.AnimatedArrow">
            <Style.Animations>
                <Animation Duration="0:0:1" IterationCount="Infinite">
                    <KeyFrame Cue="0%">
                        <Setter Property="TranslateTransform.X" Value="0"/>
                    </KeyFrame>
                    <KeyFrame Cue="50%">
                        <Setter Property="TranslateTransform.X" Value="-5"/>
                    </KeyFrame>
                    <KeyFrame Cue="100%">
                        <Setter Property="TranslateTransform.X" Value="0"/>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>
    </UserControl.Styles>

    <Grid>
        <Border Classes="card" Margin="16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Status Message -->
                <StackPanel Grid.Row="0" Margin="16,16,16,8">
                    <TextBlock Text="{Binding WelcomeMessage}"
                             FontSize="14"
                             TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Tab Control -->
                <TabControl Grid.Row="1" >
                    
                    <!-- General Tab -->
                    <TabItem Header="General">
                        <ScrollViewer Margin="8">
                            <Grid IsEnabled="{Binding CanProceed}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,8,4,8">
                                    <TextBox 
                                             Text="{Binding Variables.CustomerLegalName}"
                                             />
                                    <TextBlock Text="Example: Acme Corp" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="4,8,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.MsFallbackDomain}"
                                             />
                                    <TextBlock Text="Example: @acme.onmicrosoft.com" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,4,8">
                                    <TextBox 
                                             Text="{Binding Variables.Customer}"
                                             />
                                    <TextBlock Text="Example: acm-luc" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="4,0,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.CustomerGroupName}"
                                             />
                                    <TextBlock Text="Example: immo" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,4,8">
                                    <TextBox 
                                             Text="{Binding Variables.LanguageId}"
                                             />
                                    <TextBlock Text="Example: de-DE" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="2" Grid.Column="1" Margin="4,0,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.TimeZoneId}"
                                             />
                                    <TextBlock Text="Example: W. Europe Standard Time" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="3" Grid.Column="0" Margin="0,0,4,8">
                                    <TextBox 
                                             Text="{Binding Variables.UsageLocation}"
                                             />
                                    <TextBlock Text="Example: CH" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="3" Grid.Column="1" Margin="4,0,0,8">
                                    <Grid>
                                        <TextBox 
                                                 Text="{Binding Variables.SkuId}"
                                                 IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                                 VerticalContentAlignment="Center"
                                                 />
                                        <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                               HorizontalAlignment="Right" 
                                                               VerticalAlignment="Center"
                                                               />
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Call Queues Tab -->
                    <TabItem Header="Call Queues">
                        <ScrollViewer Margin="8">
                            <StackPanel IsEnabled="{Binding CanProceed}" Spacing="16">
                                
                                <!-- Application ID (Read-only) -->
                                <StackPanel Margin="0,0,0,8">
                                    <Grid>
                                        <TextBox 
                                                 Text="{Binding Variables.CsAppCqId}"
                                                 IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                                 VerticalContentAlignment="Center"
                                                 />
                                        <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                               HorizontalAlignment="Right" 
                                                               VerticalAlignment="Center"
                                                               />
                                    </Grid>
                                </StackPanel>

                                <!-- Call Queue Configuration Button -->
                                <Button Command="{Binding OpenCallQueueConfigurationDialogCommand}"
                                        HorizontalAlignment="Left" Classes="IconText">
                                    <StackPanel Orientation="Horizontal">
                                        <fi:SymbolIcon  Symbol="Settings" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                        <TextBlock Text="Configure Call Queue Settings" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>

                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Auto Attendants Tab -->
                    <TabItem Header="Auto Attendants">
                        <ScrollViewer Margin="8">
                            <Grid IsEnabled="{Binding CanProceed}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,8,4,8">
                                    <Grid>
                                        <TextBox 
                                                 Text="{Binding Variables.CsAppAaId}"
                                                 IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                                 VerticalContentAlignment="Center"
                                                 />
                                        <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                               HorizontalAlignment="Right" 
                                                               VerticalAlignment="Center"
                                                               />
                                    </Grid>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="4,8,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.PhoneNumberType}"
                                             />
                                    <TextBlock Text="Example: DirectRouting" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.RaaAnrName}"
                                             />
                                    <TextBlock Text="Example: hn for 'Hauptnummer'" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.RaaAnr}"
                                             />
                                    <TextBlock Text="Example: +41413290024" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,0,8">
                                    <Button Command="{Binding OpenAutoAttendantConfigurationDialogCommand}"
                                            HorizontalAlignment="Left" Classes="IconText">
                                        <StackPanel Orientation="Horizontal">
                                            <fi:SymbolIcon  Symbol="Settings" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                            <TextBlock Text="Configure Auto Attendant Settings" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>
                                    <TextBlock Text="Configure greetings and actions for Default and After Hours call flows" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <TextBlock Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2"
                                         Text="Opening Hours 1"
                                         FontSize="18"
                                         FontWeight="SemiBold"
                                         Margin="0,0,0,8"/>

                                <TextBlock Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2"
                                         Text="Note: Both Opening Hours 1 and 2 currently apply to Monday through Friday."
                                         FontSize="11"
                                         Margin="0,4,0,8"/>

                                <StackPanel Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,0,0,8" Spacing="16">
                                    <StackPanel MinWidth="100" MaxWidth="150" >
                                        <TextBox 
                                                 Text="{Binding Variables.OpeningHours1Start, Converter={StaticResource TimeSpanConverter}}"
                                                 VerticalContentAlignment="Center"
                                                 />
                                        <TextBlock Text="Example: 08:00" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel MinWidth="100" MaxWidth="150">
                                        <TextBox 
                                                 Text="{Binding Variables.OpeningHours1End, Converter={StaticResource TimeSpanConverter}}"
                                                 VerticalContentAlignment="Center"
                                                 />
                                        <TextBlock Text="Example: 12:00" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </StackPanel>

                                <TextBlock Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="2"
                                         Text="Opening Hours 2"
                                         FontSize="18"
                                         FontWeight="SemiBold"
                                         Margin="0,0,0,8"/>

                                <StackPanel Grid.Row="9" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,0,0,8" Spacing="16">
                                    <StackPanel MinWidth="100" MaxWidth="150" >
                                        <TextBox 
                                                 Text="{Binding Variables.OpeningHours2Start, Converter={StaticResource TimeSpanConverter}}"
                                                 VerticalContentAlignment="Center"
                                                 />
                                        <TextBlock Text="Example: 13:30" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel MinWidth="100" MaxWidth="150">
                                        <TextBox 
                                                 Text="{Binding Variables.OpeningHours2End, Converter={StaticResource TimeSpanConverter}}"
                                                 VerticalContentAlignment="Center"
                                                 />
                                        <TextBlock Text="Example: 17:00" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Holidays Tab -->
                    <TabItem Header="Holidays">
                        <ScrollViewer Margin="8">
                            <Grid IsEnabled="{Binding CanProceed}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,8,4,8">
                                    <Grid>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Variables.Customer, StringFormat=hd-\{0\}-, FallbackValue=hd-}" 
                                                       Opacity="0.7"
                                                       VerticalAlignment="Center"
                                                       Margin="12,0,4,0"/>
                                            <TextBox Text="{Binding Variables.HolidayNameSuffix}"
                                                     Background="Transparent"
                                                     MinWidth="200"
                                                     />
                                        </StackPanel>
                                    </Grid>
                                    <TextBlock Text="Example: kantonal-2025" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="4,8,0,8">
                                    <Button Command="{Binding OpenHolidaySeriesManagerCommand}"
                                            HorizontalAlignment="Stretch" Classes="IconText">
                                        <StackPanel Orientation="Horizontal">
                                            <fi:SymbolIcon  Symbol="Calendar" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                            <TextBlock Text="Manage Holiday Series" VerticalAlignment="Center"/>
                                            <TextBlock Text="{Binding Variables.HolidaySeries.Count, StringFormat=' ({0} holidays)'}"
                                                     Margin="8,0,0,0"
                                                     Opacity="0.7"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>
                                    <TextBlock Text="Click to manage multiple holiday dates and times" FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>

                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,0,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.HolidayGreetingPromptDE}"
                                             />
                                    <TextBlock Text="Example: Herzlich Willkommen bei der Acme Corp. Leider können wir Ihren Anruf derzeit nicht entgegennehmen, da Sie uns an einem Feiertag anrufen." FontSize="11" Margin="0,4,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Auto-generated Tab -->
                    <TabItem Header="Auto-generated">
                        <ScrollViewer Margin="8">
                            <Grid IsEnabled="{Binding CanProceed}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0" Grid.Column="0" Margin="0,8,4,8">
                                    <TextBox 
                                             Text="{Binding Variables.M365Group, Mode=OneWay}"
                                             IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                             VerticalContentAlignment="Center"
                                             />
                                    <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                           HorizontalAlignment="Right" 
                                                           VerticalAlignment="Center"
                                                           />
                                </Grid>
                                
                                <Grid Grid.Row="0" Grid.Column="1" Margin="4,8,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.RacqUPN, Mode=OneWay}"
                                             IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                             VerticalContentAlignment="Center"
                                             />
                                    <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                           HorizontalAlignment="Right" 
                                                           VerticalAlignment="Center"
                                                           />
                                </Grid>
                                
                                <Grid Grid.Row="1" Grid.Column="0" Margin="0,0,4,8">
                                    <TextBox 
                                             Text="{Binding Variables.RacqDisplayName, Mode=OneWay}"
                                             IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                             VerticalContentAlignment="Center"
                                             />
                                    <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                           HorizontalAlignment="Right" 
                                                           VerticalAlignment="Center"
                                                           />
                                </Grid>
                                
                                <Grid Grid.Row="1" Grid.Column="1" Margin="4,0,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.CqDisplayName, Mode=OneWay}"
                                             IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                             VerticalContentAlignment="Center"
                                             />
                                    <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                           HorizontalAlignment="Right" 
                                                           VerticalAlignment="Center"
                                                           />
                                </Grid>
                                
                                <Grid Grid.Row="2" Grid.Column="0" Margin="0,0,4,8">
                                    <TextBox 
                                             Text="{Binding Variables.RaaaUPN, Mode=OneWay}"
                                             IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                             VerticalContentAlignment="Center"
                                             />
                                    <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                           HorizontalAlignment="Right" 
                                                           VerticalAlignment="Center"
                                                           />
                                </Grid>
                                
                                <Grid Grid.Row="2" Grid.Column="1" Margin="4,0,0,8">
                                    <TextBox 
                                             Text="{Binding Variables.RaaaDisplayName, Mode=OneWay}"
                                             IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                             VerticalContentAlignment="Center"
                                             />
                                    <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                           HorizontalAlignment="Right" 
                                                           VerticalAlignment="Center"
                                                           />
                                </Grid>
                                
                                <Grid Grid.Row="3" Grid.Column="0" Margin="0,0,4,8">
                                    <TextBox 
                                             Text="{Binding Variables.AaDisplayName, Mode=OneWay}"
                                             IsReadOnly="True" Opacity="0.7" Background="Transparent"
                                             VerticalContentAlignment="Center"
                                             />
                                    <fi:SymbolIcon  Symbol="LockClosed" Foreground="{DynamicResource TextFillColorPrimaryBrush}" 
                                                           HorizontalAlignment="Right" 
                                                           VerticalAlignment="Center"
                                                           />
                                </Grid>
                            </Grid>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>

                <!-- Save and Load Buttons -->
                <StackPanel Grid.Row="2"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Margin="16,8,16,16"
                            Spacing="16">
                    <Button Command="{Binding LoadVariablesFromFileCommand}"
                             Classes="IconText">
                        <StackPanel Orientation="Horizontal">
                            <fi:SymbolIcon  Symbol="FolderOpen" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Load Variables from File" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    <Button Command="{Binding SaveVariablesToFileCommand}" Classes="IconText">
                        <StackPanel Orientation="Horizontal">
                            <fi:SymbolIcon  Symbol="Save" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Save Variables to File" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Holiday Time Picker Dialog - Border overlay -->
        <Border IsVisible="{Binding ShowHolidayTimePicker}"
                Background="#80000000"
                ZIndex="1000"
                PointerPressed="HolidayTimePickerBackdrop_PointerPressed">
            <Border.Styles>
                <Style Selector="Border">
                    <Style.Animations>
                        <Animation Duration="0:0:0.2">
                            <KeyFrame Cue="0%">
                                <Setter Property="Opacity" Value="0"/>
                            </KeyFrame>
                            <KeyFrame Cue="100%">
                                <Setter Property="Opacity" Value="1"/>
                            </KeyFrame>
                        </Animation>
                    </Style.Animations>
                </Style>
            </Border.Styles>
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center"
                  PointerPressed="HolidayTimePickerCard_PointerPressed">
                <Border Classes="dialog" MinWidth="400" Margin="16">
                    <StackPanel>
                        <TextBlock Text="Select Holiday Time"
                                 
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,16"/>
                        
                        <TextBlock Text="Choose a time that aligns with 15-minute boundaries:"
                                 FontSize="14"
                                 TextWrapping="Wrap"
                                 Margin="0,0,0,16"/>
                        
                        <ComboBox ItemsSource="{Binding TimeOptions}"
                                SelectedItem="{Binding SelectedHolidayTime, Mode=TwoWay}"
                                Margin="0,0,0,16">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding StringFormat='{}{0:hh\\:mm}'}" VerticalAlignment="Center"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        
                        <StackPanel Orientation="Horizontal" 
                                  HorizontalAlignment="Right"
                                  Spacing="16">
                            <Button Command="{Binding CloseHolidayTimePickerCommand}"
                                    Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon Symbol="Dismiss" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Cancel" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Command="{Binding SaveHolidayTimeCommand}" Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon  Symbol="Checkmark" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Save Time" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
        
        <!-- Holiday Series Manager Dialog - Border overlay (not Popup to avoid macOS window issues) -->
        <Border IsVisible="{Binding ShowHolidaySeriesManager}"
                Background="#80000000"
                ZIndex="1000"
                PointerPressed="HolidaySeriesManagerBackdrop_PointerPressed">
            <Border.Styles>
                <Style Selector="Border">
                    <Style.Animations>
                        <Animation Duration="0:0:0.2">
                            <KeyFrame Cue="0%">
                                <Setter Property="Opacity" Value="0"/>
                            </KeyFrame>
                            <KeyFrame Cue="100%">
                                <Setter Property="Opacity" Value="1"/>
                            </KeyFrame>
                        </Animation>
                    </Style.Animations>
                </Style>
            </Border.Styles>
            <!-- Centered dialog card -->
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center"
                  PointerPressed="HolidaySeriesManagerCard_PointerPressed">
                <Border Classes="dialog" MinWidth="600" MaxWidth="800" MaxHeight="700" Margin="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0"
                                 Text="Manage Holiday Series"
                                 
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,16"/>
                        
                        <TextBlock Grid.Row="1"
                                 Text="Add, edit, or remove holiday dates and times. Each holiday will be created with the specified date and time."
                                 FontSize="14"
                                 TextWrapping="Wrap"
                                 Margin="0,0,0,8"/>

                        <TextBlock Grid.Row="2"
                                 Text="If no time is selected, 00:00 will be used by default."
                                 FontSize="12"
                                 Opacity="0.7"
                                 Margin="0,0,0,16"/>
                        
                        <!-- Holiday List - Scrollable with proper constraints -->
                        <ScrollViewer Grid.Row="3"
                                    VerticalScrollBarVisibility="Auto"
                                    HorizontalScrollBarVisibility="Disabled"
                                    Margin="0,0,0,16">
                            <ItemsControl ItemsSource="{Binding Variables.HolidaySeries}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderThickness="0,0,0,1"
                                                Padding="0,8">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="{Binding DisplayText}"
                                                             FontSize="16"
                                                             FontWeight="SemiBold"/>
                                                    <TextBlock Text="{Binding Name, StringFormat='Holiday: {0}'}"
                                                             FontSize="12"
                                                             Opacity="0.7"
                                                             IsVisible="{Binding Name, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                                </StackPanel>
                                                
                                                <Button Grid.Column="1"
                                                        Command="{Binding DataContext.EditHolidayCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        CommandParameter="{Binding}"
                                                        Margin="8,0"
                                                        Width="40"
                                                        Height="40"
                                                        Classes="IconOnly"
                                                        Padding="0"
                                                        >
                                                    <fi:SymbolIcon  Symbol="Edit" 
                                                                  Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                                  Margin="0,-2,0,0"
                                                                  HorizontalAlignment="Center"
                                                                  VerticalAlignment="Center"/>
                                                </Button>
                                                
                                                <Button Grid.Column="2"
                                                        Command="{Binding DataContext.RemoveHolidayCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        CommandParameter="{Binding}"
                                                        Margin="8,0"
                                                        Width="40"
                                                        Height="40"
                                                        Classes="IconOnly"
                                                        Padding="0"
                                                        >
                                                    <fi:SymbolIcon  Symbol="Delete" 
                                                                  Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                                  Margin="0,-2,0,0"
                                                                  HorizontalAlignment="Center"
                                                                  VerticalAlignment="Center"/>
                                                </Button>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <!-- Add Holiday and Delete All Buttons -->
                        <StackPanel Grid.Row="4" Orientation="Horizontal" Margin="0,0,0,16" Spacing="16">
                            <Button Command="{Binding AddHolidayCommand}"
                                     Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon  Symbol="CalendarAdd" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Add Holiday" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Command="{Binding DeleteAllHolidaysCommand}" Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon  Symbol="Delete" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Delete All" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                        
                        <!-- Use Predefined Sets Button -->
                        <Button Grid.Row="5"
                                Command="{Binding OpenPredefinedHolidaysWizardCommand}"
                                HorizontalAlignment="Left"
                                Margin="0,0,0,16" Classes="IconText">
                            <StackPanel Orientation="Horizontal">
                                <fi:SymbolIcon  Symbol="Globe" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                <TextBlock Text="Use Predefined Sets…" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        
                        <!-- Action Buttons -->
                        <StackPanel Grid.Row="6"
                                  Orientation="Horizontal" 
                                  HorizontalAlignment="Right"
                                  Spacing="16">
                            <Button Command="{Binding CancelHolidaySeriesManagerCommand}"
                                    Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon Symbol="Dismiss" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Cancel" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Command="{Binding SaveHolidaySeriesCommand}" Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon  Symbol="Checkmark" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Save Series" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>
        
        <!-- Edit Holiday Dialog - Border overlay -->
        <Border IsVisible="{Binding ShowEditHolidayDialog}"
                Background="#80000000"
                ZIndex="1000"
                PointerPressed="EditHolidayBackdrop_PointerPressed">
            <Border.Styles>
                <Style Selector="Border">
                    <Style.Animations>
                        <Animation Duration="0:0:0.2">
                            <KeyFrame Cue="0%">
                                <Setter Property="Opacity" Value="0"/>
                            </KeyFrame>
                            <KeyFrame Cue="100%">
                                <Setter Property="Opacity" Value="1"/>
                            </KeyFrame>
                        </Animation>
                    </Style.Animations>
                </Style>
            </Border.Styles>
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center"
                  PointerPressed="EditHolidayCard_PointerPressed">
                <Border Classes="dialog" MinWidth="400" Margin="16">
                    <StackPanel>
                        <TextBlock Text="Edit Holiday"
                                 
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,16"/>
                        
                        <TextBlock Text="Holiday Date:"
                                 FontSize="16"
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,8"/>
                        <CalendarDatePicker SelectedDate="{Binding DialogHolidayDate, TargetNullValue={x:Static sys:DateTime.Today}}"
                                          HorizontalAlignment="Stretch"
                                          VerticalContentAlignment="Center"
                                          Margin="0,0,0,16"/>
                        
                        <TextBlock Text="Holiday Time:"
                                 FontSize="16"
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,8"/>
                        <ComboBox ItemsSource="{Binding TimeOptions}"
                                 SelectedItem="{Binding SelectedEditHolidayTime, Mode=TwoWay}"
                                 Margin="0,0,0,16">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding StringFormat='{}{0:hh\\:mm}'}" VerticalAlignment="Center"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        
                        <StackPanel Orientation="Horizontal" 
                                  HorizontalAlignment="Right"
                                  Spacing="16">
                            <Button Command="{Binding CancelEditHolidayCommand}"
                                    Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon Symbol="Dismiss" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Cancel" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Command="{Binding SaveEditHolidayCommand}" Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon  Symbol="Checkmark" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Save" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Predefined Holidays Wizard Dialog - Border overlay -->
        <Border IsVisible="{Binding ShowPredefinedHolidaysWizard}"
                Background="#80000000"
                ZIndex="1000"
                PointerPressed="PredefinedHolidaysWizardBackdrop_PointerPressed">
            <Border.Styles>
                <Style Selector="Border">
                    <Style.Animations>
                        <Animation Duration="0:0:0.2">
                            <KeyFrame Cue="0%">
                                <Setter Property="Opacity" Value="0"/>
                            </KeyFrame>
                            <KeyFrame Cue="100%">
                                <Setter Property="Opacity" Value="1"/>
                            </KeyFrame>
                        </Animation>
                    </Style.Animations>
                </Style>
            </Border.Styles>
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center"
                  PointerPressed="PredefinedHolidaysWizardCard_PointerPressed">
                <Border Classes="dialog" MinWidth="500" MaxWidth="700" Margin="16">
                    <StackPanel>
                        <TextBlock Text="Predefined Holiday Sets"
                                   
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,16"/>

                    <StackPanel Spacing="8">
                        <StackPanel Spacing="4">
                            <TextBlock Text="Country" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                            <ComboBox ItemsSource="{Binding Countries}"
                                      SelectedItem="{Binding SelectedCountry}"
                                      HorizontalAlignment="Stretch"
                                      VerticalContentAlignment="Center">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" VerticalAlignment="Center" Margin="2"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel IsVisible="{Binding IsSwitzerlandSelected, Converter={StaticResource BooleanToVisibilityConverter}}" Spacing="8">
                            <StackPanel Spacing="4">
                                <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                    <TextBlock Text="Canton" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <Button Command="{Binding ShowAargauInfoCommand}"
                                            IsVisible="{Binding IsAargauSelected, Converter={StaticResource BooleanToVisibilityConverter}}"
                                            ToolTip.Tip="Aargau Holiday Reference Information"
                                            Background="Transparent"
                                            VerticalAlignment="Center"
                                            Classes="IconOnly"
                                            Width="30"
                                            Height="30"
                                            Padding="0">
                                        <fi:SymbolIcon  Symbol="Info" 
                                                      Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                      Margin="0,-2,0,0"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"/>
                                    </Button>
                                    <!-- Animated arrow pointing to info button -->
                                    <StackPanel Orientation="Horizontal" 
                                                IsVisible="{Binding IsAargauSelected, Converter={StaticResource BooleanToVisibilityConverter}}"
                                                Spacing="4"
                                                VerticalAlignment="Center">
                                        <fi:SymbolIcon  Symbol="ArrowLeft" Foreground="{DynamicResource TeamsPrimaryBrush}" Classes="AnimatedArrow"/>
                                        <TextBlock Text="Click for reference" 
                                                   FontSize="14"
                                                   Foreground="{DynamicResource TeamsPrimaryBrush}"
                                                   Opacity="0.9"
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>
                                </StackPanel>
                                <ComboBox ItemsSource="{Binding Cantons}"
                                          SelectedItem="{Binding SelectedCanton}"
                                          HorizontalAlignment="Stretch"
                                          VerticalContentAlignment="Center">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center" Margin="2"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>

                            <StackPanel IsVisible="{Binding IsAargauSelected, Converter={StaticResource BooleanToVisibilityConverter}}" Spacing="4">
                                <TextBlock Text="Bezirk" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                <ComboBox ItemsSource="{Binding Bezirke}"
                                          SelectedItem="{Binding SelectedBezirk}"
                                          HorizontalAlignment="Stretch"
                                          VerticalContentAlignment="Center">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center" TextWrapping="Wrap" Margin="2"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Year" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                            <ComboBox ItemsSource="{Binding Years}"
                                      SelectedItem="{Binding SelectedYear}"
                                      HorizontalAlignment="Stretch"
                                      VerticalContentAlignment="Center">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" VerticalAlignment="Center" Margin="2"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0" Spacing="16">
                        <Button Command="{Binding CancelPredefinedHolidaysWizardCommand}"
                                Classes="IconText">
                            <StackPanel Orientation="Horizontal">
                                <fi:SymbolIcon Symbol="Dismiss" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                <TextBlock Text="Cancel" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button Command="{Binding ApplyPredefinedHolidaysCommand}"
                                IsEnabled="{Binding CanApplyPredefinedSelection}" Classes="IconText">
                            <StackPanel Orientation="Horizontal">
                                <fi:SymbolIcon  Symbol="Checkmark" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                <TextBlock Text="Add Holidays" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Aargau Info Dialog - Border overlay -->
        <Border IsVisible="{Binding ShowAargauInfoDialog}"
                Background="#80000000"
                ZIndex="1000"
                PointerPressed="AargauInfoBackdrop_PointerPressed">
            <Border.Styles>
                <Style Selector="Border">
                    <Style.Animations>
                        <Animation Duration="0:0:0.2">
                            <KeyFrame Cue="0%">
                                <Setter Property="Opacity" Value="0"/>
                            </KeyFrame>
                            <KeyFrame Cue="100%">
                                <Setter Property="Opacity" Value="1"/>
                            </KeyFrame>
                        </Animation>
                    </Style.Animations>
                </Style>
            </Border.Styles>
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center"
                  PointerPressed="AargauInfoCard_PointerPressed">
                <Border Classes="dialog" MinWidth="600" MaxWidth="800" Margin="16">
                    <StackPanel>
                        <TextBlock Text="Aargau Holiday Reference"
                                   
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,16"/>

                        <TextBlock Text="Use this as a reference image because the holidays in Aargau can vary yearly. Please look up the official page of the DEPARTEMENT VOLKSWIRTSCHAFT UND INNERES, Amt für Wirtschaft und Arbeit of Kanton Aargau to get the newest list."
                                   FontSize="14"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,16"/>

                        <Border BorderThickness="1"
                                BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                                CornerRadius="4"
                                Margin="0,0,0,16">
                            <Image Source="avares://teams-phonemanager/Resources/AargauHolidaysReference.png"
                                   Stretch="Uniform"
                                   MaxHeight="400"/>
                        </Border>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Command="{Binding CloseAargauInfoCommand}" Classes="IconText">
                                <StackPanel Orientation="Horizontal">
                                    <fi:SymbolIcon  Symbol="Checkmark" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="Close" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Call Queue Configuration Dialog - Border overlay -->
        <Border IsVisible="{Binding ShowCallQueueConfigurationDialog}"
                Background="#80000000"
                ZIndex="1000"
                PointerPressed="CallQueueConfigurationBackdrop_PointerPressed">
            <Border.Styles>
                <Style Selector="Border">
                    <Style.Animations>
                        <Animation Duration="0:0:0.2">
                            <KeyFrame Cue="0%">
                                <Setter Property="Opacity" Value="0"/>
                            </KeyFrame>
                            <KeyFrame Cue="100%">
                                <Setter Property="Opacity" Value="1"/>
                            </KeyFrame>
                        </Animation>
                    </Style.Animations>
                </Style>
            </Border.Styles>
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center"
                  PointerPressed="CallQueueConfigurationCard_PointerPressed">
                <Border Classes="dialog"
                        Padding="32"
                        MinWidth="800"
                        MaxWidth="1000"
                        MaxHeight="900"
                        Margin="16">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0">
                        <StackPanel Spacing="24" Margin="0">
                            <TextBlock Text="Call Queue Configuration"
                                     
                                     FontWeight="SemiBold"
                                     Margin="0,0,0,8"/>
                            
                            <!-- Greeting and Music Section -->
                            <StackPanel Spacing="24">
                                <TextBlock Text="Greeting and Music" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                
                                <StackPanel Spacing="16">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Greeting" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding GreetingTypeOptions}"
                                                  SelectedItem="{Binding Variables.CqGreetingType}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <StackPanel IsVisible="{Binding ShowGreetingAudioFile}" Spacing="8">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <StackPanel Spacing="4" HorizontalAlignment="Stretch">
                                                <TextBlock Text="Audio File" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Variables.CqGreetingAudioFileId}"
                                                         Watermark="No file selected"
                                                         IsReadOnly="True"
                                                         HorizontalAlignment="Stretch"/>
                                            </StackPanel>
                                            <Button Command="{Binding SelectGreetingAudioFileCommand}"
                                                    Classes="IconText"
                                                    VerticalAlignment="Bottom">
                                                <StackPanel Orientation="Horizontal">
                                                    <fi:SymbolIcon Symbol="FolderOpen" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                                    <TextBlock Text="Select File" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                        <TextBlock Text="Select a WAV file (max 5MB). It will be uploaded automatically." 
                                                   FontSize="11" 
                                                   Opacity="0.7"/>
                                    </StackPanel>
                                    
                                    <StackPanel IsVisible="{Binding ShowGreetingTextToSpeech}" Spacing="4">
                                        <TextBlock Text="Text to Speech Prompt" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding Variables.CqGreetingTextToSpeechPrompt}"
                                                 Watermark="Enter greeting message"/>
                                    </StackPanel>
                                </StackPanel>
                                
                                <StackPanel Spacing="16">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Music on Hold" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding MusicOnHoldTypeOptions}"
                                                  SelectedItem="{Binding Variables.CqMusicOnHoldType}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <StackPanel IsVisible="{Binding ShowMusicOnHoldAudioFile}" Spacing="8">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <StackPanel Spacing="4" HorizontalAlignment="Stretch">
                                                <TextBlock Text="Audio File" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Variables.CqMusicOnHoldAudioFileId}"
                                                         Watermark="No file selected"
                                                         IsReadOnly="True"
                                                         HorizontalAlignment="Stretch"/>
                                            </StackPanel>
                                            <Button Command="{Binding SelectMusicOnHoldAudioFileCommand}"
                                                    Classes="IconText"
                                                    VerticalAlignment="Bottom">
                                                <StackPanel Orientation="Horizontal">
                                                    <fi:SymbolIcon Symbol="FolderOpen" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                                    <TextBlock Text="Select File" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                        <TextBlock Text="Select a WAV file (max 5MB). It will be uploaded automatically." 
                                                   FontSize="11" 
                                                   Opacity="0.7"/>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Exception Handling Section -->
                            <StackPanel Spacing="24">
                                <TextBlock Text="Exception Handling" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                
                                <!-- Call Overflow -->
                                <StackPanel Spacing="16">
                                    <TextBlock Text="Call Overflow" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Maximum calls in queue" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <NumericUpDown Value="{Binding Variables.CqOverflowThreshold}"
                                                      Minimum="1"
                                                      HorizontalAlignment="Left"
                                                      Width="200"/>
                                    </StackPanel>
                                    <TextBlock Text="When the maximum number of calls is reached" FontSize="11" Opacity="0.7" VerticalAlignment="Center"/>
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Action" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding OverflowActionOptions}"
                                                  SelectedItem="{Binding Variables.CqOverflowAction}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel IsVisible="{Binding ShowOverflowTarget}" Spacing="4">
                                        <TextBlock Text="Target" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding Variables.CqOverflowActionTarget}"
                                                 Watermark="Resource Account UPN or M365 Group ID"/>
                                    </StackPanel>
                                    
                                    <!-- Voicemail Greeting (required for SharedVoicemail) -->
                                    <StackPanel IsVisible="{Binding ShowOverflowVoicemailGreeting}" Spacing="8">
                                        <TextBlock Text="Voicemail Greeting (Required)" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Spacing="4">
                                            <TextBlock Text="Greeting Type" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <ComboBox ItemsSource="{Binding VoicemailGreetingTypeOptions}"
                                                      SelectedItem="{Binding Variables.CqOverflowVoicemailGreetingType}"
                                                      HorizontalAlignment="Left"
                                                      Width="200">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                        </StackPanel>
                                        
                                        <StackPanel IsVisible="{Binding ShowOverflowVoicemailAudioFile}" Spacing="8">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <StackPanel Spacing="4" HorizontalAlignment="Stretch">
                                                    <TextBlock Text="Audio File" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Variables.CqOverflowActionAudioFileId}"
                                                             Watermark="No file selected"
                                                             IsReadOnly="True"
                                                             HorizontalAlignment="Stretch"/>
                                                </StackPanel>
                                                <Button Command="{Binding SelectOverflowVoicemailAudioFileCommand}"
                                                        Classes="IconText"
                                                        VerticalAlignment="Bottom">
                                                    <StackPanel Orientation="Horizontal">
                                                        <fi:SymbolIcon Symbol="FolderOpen" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                                        <TextBlock Text="Select File" VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                            <TextBlock Text="Select a WAV file (max 5MB). It will be uploaded automatically." 
                                                       FontSize="11" 
                                                       Opacity="0.7"/>
                                        </StackPanel>
                                        
                                        <StackPanel IsVisible="{Binding ShowOverflowVoicemailTextToSpeech}" Spacing="4">
                                            <TextBlock Text="Text to Speech Prompt" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <TextBox Text="{Binding Variables.CqOverflowActionTextToSpeechPrompt}"
                                                     Watermark="Enter voicemail greeting message"/>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                                
                                <!-- Call Timeout -->
                                <StackPanel Spacing="16">
                                    <TextBlock Text="Call Timeout" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Maximum wait time (seconds, min 30)" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <NumericUpDown Value="{Binding Variables.CqTimeoutThreshold}"
                                                      Minimum="30"
                                                      HorizontalAlignment="Left"
                                                      Width="250"/>
                                    </StackPanel>
                                    <TextBlock Text="When call times out" FontSize="11" Opacity="0.7" VerticalAlignment="Center"/>
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Action" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding TimeoutActionOptions}"
                                                  SelectedItem="{Binding Variables.CqTimeoutAction}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel IsVisible="{Binding ShowTimeoutTarget}" Spacing="4">
                                        <TextBlock Text="Target" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding Variables.CqTimeoutActionTarget}"
                                                 Watermark="Resource Account UPN or M365 Group ID"/>
                                    </StackPanel>
                                    
                                    <!-- Voicemail Greeting (required for SharedVoicemail) -->
                                    <StackPanel IsVisible="{Binding ShowTimeoutVoicemailGreeting}" Spacing="8">
                                        <TextBlock Text="Voicemail Greeting (Required)" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Spacing="4">
                                            <TextBlock Text="Greeting Type" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <ComboBox ItemsSource="{Binding VoicemailGreetingTypeOptions}"
                                                      SelectedItem="{Binding Variables.CqTimeoutVoicemailGreetingType}"
                                                      HorizontalAlignment="Left"
                                                      Width="200">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                        </StackPanel>
                                        
                                        <StackPanel IsVisible="{Binding ShowTimeoutVoicemailAudioFile}" Spacing="8">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <StackPanel Spacing="4" HorizontalAlignment="Stretch">
                                                    <TextBlock Text="Audio File" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Variables.CqTimeoutActionAudioFileId}"
                                                             Watermark="No file selected"
                                                             IsReadOnly="True"
                                                             HorizontalAlignment="Stretch"/>
                                                </StackPanel>
                                                <Button Command="{Binding SelectTimeoutVoicemailAudioFileCommand}"
                                                        Classes="IconText"
                                                        VerticalAlignment="Bottom">
                                                    <StackPanel Orientation="Horizontal">
                                                        <fi:SymbolIcon Symbol="FolderOpen" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                                        <TextBlock Text="Select File" VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                            <TextBlock Text="Select a WAV file (max 5MB). It will be uploaded automatically." 
                                                       FontSize="11" 
                                                       Opacity="0.7"/>
                                        </StackPanel>
                                        
                                        <StackPanel IsVisible="{Binding ShowTimeoutVoicemailTextToSpeech}" Spacing="4">
                                            <TextBlock Text="Text to Speech Prompt" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <TextBox Text="{Binding Variables.CqTimeoutActionTextToSpeechPrompt}"
                                                     Watermark="Enter voicemail greeting message"/>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                                
                                <!-- No Agents Available -->
                                <StackPanel Spacing="16">
                                    <TextBlock Text="No Agents Available" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <CheckBox Content="Apply settings only to new incoming calls"
                                              IsChecked="{Binding Variables.CqNoAgentApplyToNewCallsOnly}"/>
                                    <TextBlock Text="When no agents are available" FontSize="11" Opacity="0.7" VerticalAlignment="Center"/>
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Action" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding NoAgentActionOptions}"
                                                  SelectedItem="{Binding Variables.CqNoAgentAction}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel IsVisible="{Binding ShowNoAgentTarget}" Spacing="4">
                                        <TextBlock Text="Target" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding Variables.CqNoAgentActionTarget}"
                                                 Watermark="Resource Account UPN or M365 Group ID"/>
                                    </StackPanel>
                                    
                                    <!-- Voicemail Greeting (required for SharedVoicemail) -->
                                    <StackPanel IsVisible="{Binding ShowNoAgentVoicemailGreeting}" Spacing="8">
                                        <TextBlock Text="Voicemail Greeting (Required)" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Spacing="4">
                                            <TextBlock Text="Greeting Type" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <ComboBox ItemsSource="{Binding VoicemailGreetingTypeOptions}"
                                                      SelectedItem="{Binding Variables.CqNoAgentVoicemailGreetingType}"
                                                      HorizontalAlignment="Left"
                                                      Width="200">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                        </StackPanel>
                                        
                                        <StackPanel IsVisible="{Binding ShowNoAgentVoicemailAudioFile}" Spacing="8">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <StackPanel Spacing="4" HorizontalAlignment="Stretch">
                                                    <TextBlock Text="Audio File" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Variables.CqNoAgentActionAudioFileId}"
                                                             Watermark="No file selected"
                                                             IsReadOnly="True"
                                                             HorizontalAlignment="Stretch"/>
                                                </StackPanel>
                                                <Button Command="{Binding SelectNoAgentVoicemailAudioFileCommand}"
                                                        Classes="IconText"
                                                        VerticalAlignment="Bottom">
                                                    <StackPanel Orientation="Horizontal">
                                                        <fi:SymbolIcon Symbol="FolderOpen" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                                        <TextBlock Text="Select File" VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                            <TextBlock Text="Select a WAV file (max 5MB). It will be uploaded automatically." 
                                                       FontSize="11" 
                                                       Opacity="0.7"/>
                                        </StackPanel>
                                        
                                        <StackPanel IsVisible="{Binding ShowNoAgentVoicemailTextToSpeech}" Spacing="4">
                                            <TextBlock Text="Text to Speech Prompt" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <TextBox Text="{Binding Variables.CqNoAgentActionTextToSpeechPrompt}"
                                                     Watermark="Enter voicemail greeting message"/>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Action Buttons -->
                            <StackPanel Orientation="Horizontal" 
                                      HorizontalAlignment="Right"
                                      Margin="0,24,0,0"
                                      Spacing="16">
                                <Button Command="{Binding CancelCallQueueConfigurationCommand}"
                                        Classes="IconText">
                                    <StackPanel Orientation="Horizontal">
                                        <fi:SymbolIcon Symbol="Dismiss" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                        <TextBlock Text="Cancel" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                                <Button Command="{Binding SaveCallQueueConfigurationCommand}" Classes="IconText">
                                    <StackPanel Orientation="Horizontal">
                                        <fi:SymbolIcon  Symbol="Checkmark" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                        <TextBlock Text="Save" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Border>

        <!-- Auto Attendant Configuration Dialog - Border overlay -->
        <Border IsVisible="{Binding ShowAutoAttendantConfigurationDialog}"
                Background="#80000000"
                ZIndex="1000"
                PointerPressed="AutoAttendantConfigurationBackdrop_PointerPressed">
            <Border.Styles>
                <Style Selector="Border">
                    <Style.Animations>
                        <Animation Duration="0:0:0.2">
                            <KeyFrame Cue="0%">
                                <Setter Property="Opacity" Value="0"/>
                            </KeyFrame>
                            <KeyFrame Cue="100%">
                                <Setter Property="Opacity" Value="1"/>
                            </KeyFrame>
                        </Animation>
                    </Style.Animations>
                </Style>
            </Border.Styles>
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center"
                  PointerPressed="AutoAttendantConfigurationCard_PointerPressed">
                <Border Classes="dialog"
                        Padding="32"
                        MinWidth="800"
                        MaxWidth="1000"
                        MaxHeight="900"
                        Margin="16">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0">
                        <StackPanel Spacing="24" Margin="0">
                            <TextBlock Text="Auto Attendant Configuration"
                                     
                                     FontWeight="SemiBold"
                                     Margin="0,0,0,8"/>
                            
                            <!-- Default Call Flow Section -->
                            <StackPanel Spacing="24">
                                <TextBlock Text="Default Call Flow (Business Hours)" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                
                                <StackPanel Spacing="16">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Greeting" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding AaGreetingTypeOptions}"
                                                  SelectedItem="{Binding Variables.AaDefaultGreetingType}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <StackPanel IsVisible="{Binding ShowAaDefaultGreetingAudioFile}" Spacing="8">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <StackPanel Spacing="4" HorizontalAlignment="Stretch">
                                                <TextBlock Text="Audio File" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Variables.AaDefaultGreetingAudioFileId}"
                                                         Watermark="No file selected"
                                                         IsReadOnly="True"
                                                         HorizontalAlignment="Stretch"/>
                                            </StackPanel>
                                            <Button Command="{Binding SelectAaDefaultGreetingAudioFileCommand}"
                                                    Classes="IconText"
                                                    VerticalAlignment="Bottom">
                                                <StackPanel Orientation="Horizontal">
                                                    <fi:SymbolIcon Symbol="FolderOpen" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                                    <TextBlock Text="Select File" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                        <TextBlock Text="Select a WAV file (max 5MB). It will be uploaded automatically." 
                                                   FontSize="11" 
                                                   Opacity="0.7"/>
                                    </StackPanel>
                                    
                                    <StackPanel IsVisible="{Binding ShowAaDefaultGreetingTextToSpeech}" Spacing="4">
                                        <TextBlock Text="Text to Speech Prompt" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding Variables.AaDefaultGreetingTextToSpeechPrompt}"
                                                 Watermark="Enter greeting message"/>
                                    </StackPanel>

                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Action" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding AaActionOptions}"
                                                  SelectedItem="{Binding Variables.AaDefaultAction}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel IsVisible="{Binding ShowAaDefaultTarget}" Spacing="4">
                                        <TextBlock Text="Target" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding Variables.AaDefaultActionTarget}"
                                                 Watermark="Resource Account UPN or M365 Group ID"/>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- After Hours Call Flow Section -->
                            <StackPanel Spacing="24">
                                <TextBlock Text="After Hours Call Flow" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                
                                <StackPanel Spacing="16">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Greeting" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding AaGreetingTypeOptions}"
                                                  SelectedItem="{Binding Variables.AaAfterHoursGreetingType}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    
                                    <StackPanel IsVisible="{Binding ShowAaAfterHoursGreetingAudioFile}" Spacing="8">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <StackPanel Spacing="4" HorizontalAlignment="Stretch">
                                                <TextBlock Text="Audio File" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Variables.AaAfterHoursGreetingAudioFileId}"
                                                         Watermark="No file selected"
                                                         IsReadOnly="True"
                                                         HorizontalAlignment="Stretch"/>
                                            </StackPanel>
                                            <Button Command="{Binding SelectAaAfterHoursGreetingAudioFileCommand}"
                                                    Classes="IconText"
                                                    VerticalAlignment="Bottom">
                                                <StackPanel Orientation="Horizontal">
                                                    <fi:SymbolIcon Symbol="FolderOpen" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                                    <TextBlock Text="Select File" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                        <TextBlock Text="Select a WAV file (max 5MB). It will be uploaded automatically." 
                                                   FontSize="11" 
                                                   Opacity="0.7"/>
                                    </StackPanel>
                                    
                                    <StackPanel IsVisible="{Binding ShowAaAfterHoursGreetingTextToSpeech}" Spacing="4">
                                        <TextBlock Text="Text to Speech Prompt" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding Variables.AaAfterHoursGreetingTextToSpeechPrompt}"
                                                 Watermark="Enter greeting message"/>
                                    </StackPanel>

                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Action" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <ComboBox ItemsSource="{Binding AaActionOptions}"
                                                  SelectedItem="{Binding Variables.AaAfterHoursAction}"
                                                  HorizontalAlignment="Left"
                                                  Width="200">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel IsVisible="{Binding ShowAaAfterHoursTarget}" Spacing="4">
                                        <TextBlock Text="Target" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <TextBox Text="{Binding Variables.AaAfterHoursActionTarget}"
                                                 Watermark="Resource Account UPN or M365 Group ID"/>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Action Buttons -->
                            <StackPanel Orientation="Horizontal" 
                                      HorizontalAlignment="Right"
                                      Margin="0,24,0,0"
                                      Spacing="16">
                                <Button Command="{Binding CancelAutoAttendantConfigurationCommand}"
                                        Classes="IconText">
                                    <StackPanel Orientation="Horizontal">
                                        <fi:SymbolIcon Symbol="Dismiss" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                        <TextBlock Text="Cancel" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                                <Button Command="{Binding SaveAutoAttendantConfigurationCommand}" Classes="IconText">
                                    <StackPanel Orientation="Horizontal">
                                        <fi:SymbolIcon  Symbol="Checkmark" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                                        <TextBlock Text="Save" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>